---
title: Nim vk-get-pictures
abbrlink: 3170392974
date: 2021-05-21 23:58:25
tags: [nim, vk]
---

Вторая программа на Nim – скрипт скачивания картинок из альбома Vkontakte.

<!-- more -->
{% post_link 150324-scala_vk_get_pictures '(2015) - Версия на Scala' %} 

Следующий эксперимент после решения {% post_link 210504-nim-in-imaginery-world 'задачи Джеймса Бонда-младшего' %} - скрипт для выкачивания всех картинок из альбома вконтакте в несколько потоков.

{% spoiler gist %}
{% gist 3add8ce6df83f22b524859f0957069b5 nim_vk_get_pictures.nim %}
{% endspoiler %}

Смысл выбора задачи - попробовать использовать Nim в качестве скриптового языка, для написания *quick-and-dirty* кода.

Код на **`Nim`**, написанный в таком стиле, похож на **`Pascal`**. Однако после изучения стиля нескольких библиотек становятся ощутимее различия. Разница в том, что импортируется из модулей в программу. Это не просто "структуры данных и алгоритмы", а элементы синтаксиса. В **`Nim`**, по сравнению с **`Python`**, меньше синтаксического сахара в языке, но его можно добавить, импортируя "сахарные" библиотеки. Практически, каждый модуль может быть написан на своём "микро-языке", в зависимости от того, что он импортирует.

Примеры библиотек:
[Async/await](https://youtu.be/i0RB7UqxERE)
[Pattern matching](https://nim-lang.org/blog/2021/03/10/fusion-and-pattern-matching.html)
[HTML DSL](https://github.com/juancarlospaco/nim-html-dsl)

В терминах Фаулера из книги "Предметно-ориентированные языки программирования", библиотеки могут представлять `свободные API` (fluent interface, "языкообразные апи") или `API командных запросов` ("обычные" для объектного программирования вызовы методов у объектов), причем одна и та же библиотека может представлять различные API для работы с ней.

Гибкий синтаксис приближает **`Nim`** к таким языкам, как **`Lisp`** или **`Smalltalk`**. Возможно, правильный выбор языков может сильно [уменьшать количество строк кода](https://www.computerra.ru/183817/steps/), необходимого для решения задач, хотя пока о том, что даст языково-ориентированное программирование, больше мечтают ([MPS](https://rsdn.org/article/philosophy/LOP.xml), [Language Workbenches](https://martinfowler.com/articles/languageWorkbench.html), [Racket](https://youtu.be/z8Pz4bJV3Tk)).


Вдобавок к изменениям синтаксиса, компилятор имеет переключатели, существенно меняющие поведение ([hot code reload](https://nim-lang.org/docs/hcr.html), [ARC garbage collector](https://forum.nim-lang.org/t/5734), [threads](https://nim-lang.org/docs/threads.html)) и использовать C++ в качестве ["ассемблера"](https://youtu.be/8SoJR3sCaR4) для сборки под разные платформы.


